% Program 12.2
close all; clear all
%Up sampling filter  (see Chapter 7 for FIR filter design)
B =[ -0.00012783931504   0.00069976044649   0.00123831516738   0.00100277549136...
  -0.00025059018468  -0.00203448515158  -0.00300830295487  -0.00174101657599...
   0.00188598835011   0.00578414933758   0.00649330625041   0.00177982369523...
  -0.00670672686935  -0.01319379342716  -0.01116855281442   0.00123034314117...
   0.01775600060894   0.02614700427364   0.01594155162392  -0.01235169936557...
  -0.04334322148505  -0.05244745563466  -0.01951094855292   0.05718573279009...
   0.15568416401644   0.23851539047347   0.27083333333333   0.23851539047347...
   0.15568416401644   0.05718573279009  -0.01951094855292  -0.05244745563466...
  -0.04334322148505  -0.01235169936557   0.01594155162392   0.02614700427364...
   0.01775600060894   0.00123034314117  -0.01116855281442  -0.01319379342716...
  -0.00670672686935   0.00177982369523   0.00649330625041   0.00578414933758...
   0.00188598835011  -0.00174101657599  -0.00300830295487  -0.00203448515158...
  -0.00025059018468   0.00100277549136   0.00123831516738   0.00069976044649...
  -0.00012783931504];
% Generate 2048 samples with fs=8000 Hz
fs=8000;                                       % sampling rate 
N=2048;                                       % number of samples
L = 3;                                            % up sampling factor 
n=0:1:N-1;
x=5*sin(n*pi/4)+cos(5*n*pi/8);
% up sampling by a factor of L
w=zeros(1,L*N);
for n=0:1:N-1
  w(L*n+1)=x(n+1);                 
end
NL = length(w);                    % length of the up sampled  data
W=2*abs(fft(w,NL))/NL;W(1)=W(1)/2; %compute one-sided amplitude spectrum
f=[0:1:NL/2-1]*fs*L/NL;  % map the frequency index to the frequency (Hz)
%interpolation
y=filter(B,1,w);        % apply interpolation filter
Y=2*abs(fft(y,NL))/NL;Y(1)=Y(1)/2; %compute one-sided amplitude spectrum
fsL=[0:1:NL/2-1]*fs*L/NL; % map the frequency index to the frequency (Hz)
subplot(2,1,1);plot(f,W(1:1:NL/2));grid; xlabel('Frequency (Hz)'); 
subplot(2,1,2);plot(fsL,Y(1:1:NL/2));grid; xlabel('Frequency (Hz)');
