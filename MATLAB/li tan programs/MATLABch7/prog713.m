% MATLAB Program 7.13 for Eample 7.19
% MATLAB program to create Figure 7.40B
close all;clear all; clc;
%FIR filter coefficients:
Bham =[
   0.00000000000000
  -0.00276854711076
   0.00000000000000
   0.00759455135346
   0.00000000000000
  -0.01914148493949
   0.00000000000000
   0.04195685650042
   0.00000000000000
  -0.09180790496577
   0.00000000000000
   0.31332065886015
   0.50000000000000
   0.31332065886015
   0.00000000000000
  -0.09180790496577
   0.00000000000000
   0.04195685650042
   0.00000000000000
  -0.01914148493949
   0.00000000000000
   0.00759455135346
   0.00000000000000
  -0.00276854711076
   0.00000000000000];

%Quantized FIR filter coefficients:
BhamQ =[
   0.0000000
  -0.0000000
   0.0000000
   0.0078125
   0.0000000
  -0.0156250
   0.0000000
   0.0390625
   0.0000000
  -0.0859375
   0.0000000
   0.3125000
   0.5000000
   0.3125000
   0.0000000
   -0.0859375
   0.0000000
   0.0390625
   0.0000000
  -0.0156250
   0.0000000
   0.0078125
   0.0000000
  -0.0000000
   0.0000000];
fs=8000;
[hham,f]=freqz(Bham,1,512,fs);
[hhamQ,f]=freqz(BhamQ,1,512,fs);
p=180*unwrap(angle(hham))/pi;
pQ=180*unwrap(angle(hhamQ))/pi;
subplot(2,1,1);
plot(f,20*log10(abs(hham)),'k',f,20*log10(abs(hhamQ)),'k:');grid
axis([0 fs/2 -100 10]);
xlabel('Frequency (Hz)');
ylabel('Magnitude Response (dB)');
subplot(2,1,2);
plot(f,p,'k',f,pQ,'k:');grid
xlabel('Frequency (Hz)');
ylabel('Phase (degrees)');

